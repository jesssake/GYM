<div class="management-card">
  <h1>Gesti√≥n de Usuarios</h1>
  <p>
    Panel para administrar usuarios registrados, roles y entrenadores.
  </p>

  <div class="action-panel">
    <input
      type="text"
      placeholder="Buscar usuario o correo electr√≥nico..."
      class="text-input search-input"
      style="flex-grow: 1;"
      [(ngModel)]="searchTerm"
      (keyup.enter)="buscarUsuarios()"
    />

    <button class="btn-primary" (click)="buscarUsuarios()">
      Buscar
    </button>

    <button class="btn-secondary" (click)="agregarEntrenador()">
      Agregar Entrenador
    </button>
  </div>

  <!-- CARGANDO -->
  <div *ngIf="isLoading" class="loading-indicator" style="text-align:center; padding:20px;">
    Cargando usuarios...
  </div>

  <!-- TABLA -->
  <table class="data-table" *ngIf="!isLoading && users.length > 0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Correo</th>
        <th>Rol</th>
        <th>Fecha Registro</th>
        <th>Acciones</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let user of users">
        <td>{{ user.id }}</td>
        <td>{{ user.nombre }}</td>
        <td>{{ user.email }}</td>

        <!-- ‚úÖ Rol en min√∫sculas -->
        <td>{{ user.rol }}</td>

        <td>{{ user.fecha_registro | date:'mediumDate' }}</td>

        <td>
          <!-- üîÑ CAMBIAR ROL (cliente <-> coach) -->
          <button
            *ngIf="user.rol !== 'admin'"
            class="btn-action"
            (click)="cambiarRol(user.id, user.rol)"
          >
            Cambiar a {{ user.rol === 'cliente' ? 'coach' : 'cliente' }}
          </button>

          <!-- üóë ELIMINAR -->
          <button
            class="btn-action danger"
            (click)="eliminarUsuario(user.id)"
          >
            Eliminar
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- VAC√çO -->
  <div *ngIf="!isLoading && users.length === 0" style="text-align:center; padding:20px;">
    No se encontraron usuarios.
  </div>
</div>
