<div class="gym-dark-container">
  <!-- HEADER PRINCIPAL -->
  <header class="gym-header">
    <div class="gym-header-content">
      <div>
        <h1 class="gym-title">
          <span class="gym-title-icon">üèãÔ∏è</span>
          Gesti√≥n de Servicios
        </h1>
        <p class="gym-subtitle">Administra los servicios y categor√≠as de tu gimnasio</p>
      </div>
      
      <div class="gym-header-stats">
        <div class="gym-stat-card">
          <div class="gym-stat-icon">üìä</div>
          <div>
            <p class="gym-stat-label">Total Servicios</p>
            <p class="gym-stat-value">{{totalServicios}}</p>
          </div>
        </div>
        <div class="gym-stat-card">
          <div class="gym-stat-icon">üè∑Ô∏è</div>
          <div>
            <p class="gym-stat-label">Categor√≠as</p>
            <p class="gym-stat-value">{{totalCategorias}}</p>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- TABS DE NAVEGACI√ìN -->
  <nav class="gym-tabs">
    <button 
      (click)="cambiarTab('servicios')"
      [class.active]="tabActiva === 'servicios'"
      class="gym-tab-btn"
    >
      <span class="gym-tab-icon">üèãÔ∏è</span>
      Servicios
      <span class="gym-tab-count">{{totalServicios}}</span>
    </button>
    
    <button 
      (click)="cambiarTab('categorias')"
      [class.active]="tabActiva === 'categorias'"
      class="gym-tab-btn"
    >
      <span class="gym-tab-icon">üè∑Ô∏è</span>
      Categor√≠as
      <span class="gym-tab-count">{{totalCategorias}}</span>
    </button>
  </nav>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="gym-main-content">
    
    <!-- SECCI√ìN SERVICIOS -->
    <section *ngIf="tabActiva === 'servicios'" class="gym-section">
      <!-- FILTROS Y ACCIONES -->
      <div class="gym-actions-bar">
        <div class="gym-filters">
          <div class="gym-search">
            <span class="gym-search-icon">üîç</span>
            <input 
              type="text" 
              [(ngModel)]="filtroServicio"
              (ngModelChange)="onFiltroChange()"
              placeholder="Buscar servicio..."
              class="gym-search-input"
            >
          </div>
          
          <select 
            [(ngModel)]="filtroCategoria"
            (ngModelChange)="onFiltroChange()"
            class="gym-select"
          >
            <option value="">Todas las categor√≠as</option>
            <option *ngFor="let cat of categorias" [value]="cat.id">
              {{cat.nombre}}
            </option>
          </select>
        </div>
        
        <button 
          (click)="abrirModalCrearServicio()"
          class="gym-primary-btn"
        >
          <span>+</span>
          Nuevo Servicio
        </button>
      </div>

      <!-- ESTAD√çSTICAS -->
      <div class="gym-stats-grid">
        <div class="gym-stat-item">
          <div class="gym-stat-item-icon bg-blue-500/20">
            <span class="text-blue-400">‚úÖ</span>
          </div>
          <div>
            <p class="gym-stat-item-label">Activos</p>
            <p class="gym-stat-item-value">{{serviciosActivos}}</p>
          </div>
        </div>
        
        <div class="gym-stat-item">
          <div class="gym-stat-item-icon bg-yellow-500/20">
            <span class="text-yellow-400">‚≠ê</span>
          </div>
          <div>
            <p class="gym-stat-item-label">Destacados</p>
            <p class="gym-stat-item-value">{{serviciosDestacados}}</p>
          </div>
        </div>
        
        <div class="gym-stat-item">
          <div class="gym-stat-item-icon bg-purple-500/20">
            <span class="text-purple-400">üìä</span>
          </div>
          <div>
            <p class="gym-stat-item-label">Por Categor√≠a</p>
            <p class="gym-stat-item-value">{{serviciosPorCategoria}}</p>
          </div>
        </div>
      </div>

      <!-- TABLA DE SERVICIOS -->
      <div class="gym-table-container">
        <table class="gym-table">
          <thead>
            <tr>
              <th>Servicio</th>
              <th>Descripci√≥n</th>
              <th>Categor√≠a</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let servicio of serviciosFiltrados" class="gym-table-row">
              <td>
                <div class="gym-service-info">
                  <div class="gym-service-icon">
                    {{obtenerIconoCategoria(servicio.categoriaId)}}
                  </div>
                  <div>
                    <p class="gym-service-name">{{servicio.nombre}}</p>
                    <p class="gym-service-id">ID: {{servicio.id}}</p>
                  </div>
                </div>
              </td>
              <td>
                <p class="gym-service-desc">{{servicio.descripcion}}</p>
              </td>
              <td>
                <span class="gym-category-badge">
                  {{obtenerNombreCategoria(servicio.categoriaId)}}
                </span>
              </td>
              <td>
                <span 
                  [class]="'gym-status-badge ' + obtenerColorEstado(servicio.activo)"
                  (click)="alternarActivoServicio(servicio)"
                >
                  {{obtenerTextoEstado(servicio.activo)}}
                </span>
              </td>
              <td>
                <div class="gym-actions">
                  <button 
                    (click)="abrirModalEditarServicio(servicio)"
                    class="gym-action-btn edit"
                    title="Editar"
                  >
                    ‚úèÔ∏è
                  </button>
                  <button 
                    (click)="alternarDestacadoServicio(servicio)"
                    class="gym-action-btn star"
                    [class.active]="servicio.destacado"
                    title="Destacar"
                  >
                    {{servicio.destacado ? '‚≠ê' : '‚òÜ'}}
                  </button>
                  <button 
                    (click)="eliminarServicio(servicio.id)"
                    class="gym-action-btn delete"
                    title="Eliminar"
                  >
                    üóëÔ∏è
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <!-- ESTADO VAC√çO -->
        <div *ngIf="serviciosFiltrados.length === 0" class="gym-empty-state">
          <div class="gym-empty-icon">üèãÔ∏è</div>
          <h3>No hay servicios</h3>
          <p>{{servicios.length === 0 ? 'Comienza creando tu primer servicio' : 'No se encontraron resultados'}}</p>
          <button 
            (click)="abrirModalCrearServicio()"
            class="gym-primary-btn"
          >
            Crear Primer Servicio
          </button>
        </div>
      </div>
    </section>

    <!-- SECCI√ìN CATEGOR√çAS -->
    <section *ngIf="tabActiva === 'categorias'" class="gym-section">
      <!-- BARRA DE ACCIONES CATEGOR√çAS -->
      <div class="gym-actions-bar">
        <div class="gym-filters">
          <div class="gym-search">
            <span class="gym-search-icon">üîç</span>
            <input 
              type="text" 
              [(ngModel)]="filtroCategoriaBusqueda"
              (ngModelChange)="onFiltroCategoriaBusquedaChange()"
              placeholder="Buscar categor√≠a..."
              class="gym-search-input"
            >
          </div>
        </div>
        
        <button 
          (click)="abrirModalCrearCategoria()"
          class="gym-primary-btn"
        >
          <span>+</span>
          Nueva Categor√≠a
        </button>
      </div>

      <!-- ESTAD√çSTICAS CATEGOR√çAS -->
      <div class="gym-stats-grid">
        <div class="gym-stat-item">
          <div class="gym-stat-item-icon bg-purple-500/20">
            <span class="text-purple-400">üè∑Ô∏è</span>
          </div>
          <div>
            <p class="gym-stat-item-label">Total</p>
            <p class="gym-stat-item-value">{{totalCategorias}}</p>
          </div>
        </div>
        
        <div class="gym-stat-item">
          <div class="gym-stat-item-icon bg-green-500/20">
            <span class="text-green-400">‚úÖ</span>
          </div>
          <div>
            <p class="gym-stat-item-label">En Uso</p>
            <p class="gym-stat-item-value">{{categoriasEnUso}}</p>
          </div>
        </div>
        
        <div class="gym-stat-item">
          <div class="gym-stat-item-icon bg-blue-500/20">
            <span class="text-blue-400">üìà</span>
          </div>
          <div>
            <p class="gym-stat-item-label">Promedio</p>
            <p class="gym-stat-item-value">{{serviciosPorCategoria}}</p>
          </div>
        </div>
      </div>

      <!-- GRID DE CATEGOR√çAS -->
      <div class="gym-categories-grid">
        <div *ngFor="let categoria of categoriasFiltradas" class="gym-category-card">
          <!-- HEADER DE CATEGOR√çA -->
          <div 
            class="gym-category-header"
            [style.background]="categoria.color"
          >
            <div class="gym-category-header-content">
              <div class="gym-category-title">
                <span class="gym-category-icon">{{categoria.icono}}</span>
                <h3>{{categoria.nombre}}</h3>
              </div>
              <span class="gym-category-count">
                {{contarServiciosPorCategoria(categoria.id)}} servicios
              </span>
            </div>
            <p class="gym-category-desc">{{categoria.descripcion || 'Sin descripci√≥n'}}</p>
          </div>

          <!-- BODY DE CATEGOR√çA -->
          <div class="gym-category-body">
            <!-- INFO -->
            <div class="gym-category-info">
              <div class="gym-category-status">
                <div 
                  class="gym-status-dot"
                  [class.active]="categoria.activa"
                ></div>
                <span>{{categoria.activa ? 'Activa' : 'Inactiva'}}</span>
              </div>
              <span class="gym-category-date">{{categoria.fechaCreacion}}</span>
            </div>

            <!-- ACCIONES -->
            <div class="gym-category-actions">
              <button 
                (click)="abrirModalEditarCategoria(categoria)"
                class="gym-secondary-btn"
              >
                ‚úèÔ∏è Editar
              </button>
              <button 
                (click)="alternarActivaCategoria(categoria)"
                [class]="categoria.activa ? 'gym-danger-btn' : 'gym-success-btn'"
              >
                {{categoria.activa ? '‚úó Desactivar' : '‚úì Activar'}}
              </button>
              <button 
                (click)="eliminarCategoria(categoria.id)"
                class="gym-delete-btn"
                [disabled]="contarServiciosPorCategoria(categoria.id) > 0"
              >
                üóëÔ∏è Eliminar
              </button>
            </div>

            <!-- SERVICIOS ASOCIADOS -->
            <div 
              *ngIf="contarServiciosPorCategoria(categoria.id) > 0"
              class="gym-category-services"
            >
              <p class="gym-services-title">Servicios asociados:</p>
              <div class="gym-services-list">
                <div 
                  *ngFor="let servicio of obtenerServiciosPorCategoria(categoria.id)"
                  class="gym-service-item"
                >
                  <div class="gym-service-dot"></div>
                  <span>{{servicio.nombre}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ESTADO VAC√çO CATEGOR√çAS -->
      <div *ngIf="categoriasFiltradas.length === 0" class="gym-empty-state">
        <div class="gym-empty-icon">üè∑Ô∏è</div>
        <h3>No hay categor√≠as</h3>
        <p>Organiza tus servicios creando categor√≠as</p>
        <button 
          (click)="abrirModalCrearCategoria()"
          class="gym-primary-btn"
        >
          Crear Primera Categor√≠a
        </button>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="gym-footer">
    <div class="gym-footer-content">
      <div>
        <h4>Sistema de Gesti√≥n</h4>
        <p>¬© 2024 Gimnasio Premium. Todos los derechos reservados.</p>
      </div>
      <div class="gym-footer-actions">
        <button 
          (click)="exportarDatos()"
          class="gym-export-btn"
        >
          üì§ Exportar Datos
        </button>
      </div>
    </div>
  </footer>

  <!-- MODAL SERVICIO -->
  <div *ngIf="showModalServicio" class="gym-modal-overlay">
    <div class="gym-modal">
      <div class="gym-modal-header">
        <h2>{{modoEdicionServicio ? '‚úèÔ∏è Editar Servicio' : '‚ú® Nuevo Servicio'}}</h2>
        <button (click)="cerrarModalServicio()" class="gym-modal-close">‚úï</button>
      </div>
      
      <form (ngSubmit)="guardarServicio()" class="gym-modal-form">
        <div class="gym-form-group">
          <label>Nombre del Servicio *</label>
          <input 
            type="text" 
            [(ngModel)]="servicioSeleccionado.nombre"
            name="nombre"
            required
            placeholder="Ej: Entrenamiento Personalizado"
            class="gym-form-input"
          >
        </div>
        
        <div class="gym-form-group">
          <label>Descripci√≥n</label>
          <textarea 
            [(ngModel)]="servicioSeleccionado.descripcion"
            name="descripcion"
            placeholder="Describe el servicio..."
            rows="3"
            class="gym-form-input"
          ></textarea>
        </div>
        
        <div class="gym-form-group">
          <label>Categor√≠a *</label>
          <div class="gym-categories-selector">
            <div 
              *ngFor="let cat of categorias"
              (click)="servicioSeleccionado.categoriaId = cat.id"
              [class.selected]="servicioSeleccionado.categoriaId === cat.id"
              class="gym-category-option"
            >
              <span>{{cat.icono}}</span>
              <span>{{cat.nombre}}</span>
            </div>
          </div>
          <select 
            [(ngModel)]="servicioSeleccionado.categoriaId"
            name="categoriaId"
            required
            class="gym-form-input"
          >
            <option value="">Seleccionar categor√≠a...</option>
            <option *ngFor="let cat of categorias" [value]="cat.id">
              {{cat.icono}} {{cat.nombre}}
            </option>
          </select>
        </div>
        
        <div class="gym-form-checkbox">
          <label>
            <input 
              type="checkbox" 
              [(ngModel)]="servicioSeleccionado.activo"
              name="activo"
            >
            <span>Servicio activo</span>
          </label>
        </div>
        
        <div class="gym-form-checkbox">
          <label>
            <input 
              type="checkbox" 
              [(ngModel)]="servicioSeleccionado.destacado"
              name="destacado"
            >
            <span>Destacar servicio</span>
          </label>
        </div>
        
        <div class="gym-modal-actions">
          <button 
            type="button"
            (click)="cerrarModalServicio()"
            class="gym-secondary-btn"
          >
            Cancelar
          </button>
          <button 
            type="submit"
            class="gym-primary-btn"
          >
            {{modoEdicionServicio ? 'Guardar' : 'Crear'}}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL CATEGOR√çA -->
  <div *ngIf="showModalCategoria" class="gym-modal-overlay">
    <div class="gym-modal">
      <div class="gym-modal-header">
        <h2>{{modoEdicionCategoria ? '‚úèÔ∏è Editar Categor√≠a' : '‚ú® Nueva Categor√≠a'}}</h2>
        <button (click)="cerrarModalCategoria()" class="gym-modal-close">‚úï</button>
      </div>
      
      <form (ngSubmit)="guardarCategoria()" class="gym-modal-form">
        <div class="gym-form-group">
          <label>Nombre de la Categor√≠a *</label>
          <input 
            type="text" 
            [(ngModel)]="categoriaSeleccionada.nombre"
            name="nombre"
            required
            placeholder="Ej: Entrenamiento"
            class="gym-form-input"
          >
        </div>
        
        <div class="gym-form-group">
          <label>Descripci√≥n</label>
          <textarea 
            [(ngModel)]="categoriaSeleccionada.descripcion"
            name="descripcion"
            placeholder="Describe esta categor√≠a..."
            rows="2"
            class="gym-form-input"
          ></textarea>
        </div>
        
        <div class="gym-form-group">
          <label>Color *</label>
          <div class="gym-colors-grid">
            <div 
              *ngFor="let color of colores"
              (click)="categoriaSeleccionada.color = color"
              [class.selected]="categoriaSeleccionada.color === color"
              class="gym-color-option"
              [style.background]="color"
            ></div>
          </div>
          <input 
            type="color" 
            [(ngModel)]="categoriaSeleccionada.color"
            name="color"
            class="gym-color-input"
          >
        </div>
        
        <div class="gym-form-group">
          <label>Icono *</label>
          <div class="gym-icons-grid">
            <div 
              *ngFor="let icono of iconos"
              (click)="categoriaSeleccionada.icono = icono"
              [class.selected]="categoriaSeleccionada.icono === icono"
              class="gym-icon-option"
            >
              {{icono}}
            </div>
          </div>
          <input 
            type="text" 
            [(ngModel)]="categoriaSeleccionada.icono"
            name="icono"
            required
            placeholder="Selecciona un icono"
            class="gym-form-input"
          >
        </div>
        
        <div class="gym-form-checkbox">
          <label>
            <input 
              type="checkbox" 
              [(ngModel)]="categoriaSeleccionada.activa"
              name="activa"
            >
            <span>Categor√≠a activa</span>
          </label>
        </div>
        
        <div class="gym-modal-actions">
          <button 
            type="button"
            (click)="cerrarModalCategoria()"
            class="gym-secondary-btn"
          >
            Cancelar
          </button>
          <button 
            type="submit"
            class="gym-primary-btn"
          >
            {{modoEdicionCategoria ? 'Guardar' : 'Crear'}}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>