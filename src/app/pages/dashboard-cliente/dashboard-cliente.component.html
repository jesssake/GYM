<div class="dashboard-container">

    <header class="welcome-header">
        <h1>{{ getGreeting() }}, {{ userName }}</h1>
        <p>Tu meta actual: <strong>{{ userLevel }}</strong>. ¬°Sigue con tu progreso!</p>
    </header>

    <div class="membership-status-card highlight-card">
        <h2 style="margin-top: 0;">Mi Membres√≠a</h2>
        <ng-container *ngIf="isMembresiaLoading; else membresiaContent">
            <p>Cargando estado de membres√≠a...</p>
        </ng-container>

        <ng-template #membresiaContent>
            <ng-container *ngIf="membershipStatus; else noMembresia">
                <p>Plan Activo: <strong>{{ membershipStatus.plan_name }}</strong></p>
                <p>Expira el: <strong>{{ membershipStatus.fecha_fin | date: 'longDate' }}</strong></p>
            </ng-container>
            <ng-template #noMembresia>
                <p style="color: #f44336; font-weight: bold;">‚ö†Ô∏è No tienes una membres√≠a activa.</p>
                <a [routerLink]="['/area-privada/planes']" class="btn-primary">Ver Planes Disponibles</a>
            </ng-template>
        </ng-template>
    </div>

    <div class="metrics-grid">
        <div class="metric-card" *ngFor="let metric of metrics">
            <i class="fas {{ metric.icon }}"></i>
            <span class="value">{{ metric.value }}</span>
            <span class="label">{{ metric.label }}</span>
        </div>
    </div>

    <div class="quick-actions">
        <h2>Mi Rutina de Hoy</h2>
        <div class="highlight-card" *ngIf="!isRoutineLoading">
             <p>Rutina: <strong>{{ currentRoutineTitle }}</strong></p>
             <a [routerLink]="['/area-privada/mis-entrenamientos']" class="btn-info" *ngIf="currentRoutineTitle !== 'No tienes una rutina asignada.'">
                Iniciar Rutina
             </a>
        </div>
        <div class="actions-grid" *ngIf="!isRoutineLoading">
            <a [routerLink]="[action.path]" class="action-card" *ngFor="let action of quickActions">
                <i class="fas {{ action.icon }} icon-large"></i>
                <p>{{ action.title }}</p>
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>

    <div class="content-section">
        <h2>üì¢ Avisos y Noticias</h2>

        <ng-container *ngIf="activeNotices.length > 0; else noNotices">
            <div class="highlight-card notice-card" *ngFor="let notice of activeNotices | slice:0:3">
                <p class="notice-title"><strong>{{ notice.titulo }}</strong></p>
                <p class="notice-message">{{ notice.mensaje }}</p>
                <span class="notice-date">Publicado: {{ notice.fecha_inicio | date: 'shortDate' }}</span>
            </div>
        </ng-container>

        <ng-template #noNotices>
            <div class="highlight-card">
                 <p>No hay avisos ni eventos destacados por ahora. ¬°A seguir entrenando!</p>
            </div>
        </ng-template>
    </div>

</div>
